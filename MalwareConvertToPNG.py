import os
import scipy
import array
import numpy
from scipy.misc import imsave

for file in os.listdir("./malware/"):
    if os.path.splitext(file)[1]=='.dll':
        print(file)
        # filename = '33b711ab30af29989a95d76cb05eb0fe.dll'
        filename = "./malware/"+file
        f = open(filename, 'rb')
        ln = os.path.getsize(filename)
        print(ln)
        width = 256
        rem = ln % width
        print(rem)
        a = array.array("B")
        a.fromfile(f, ln-rem)
        f.close()

        g = numpy.resize(a, (width, width))
        # g = numpy.reshape(a, (len(a)//width, width))
        g = numpy.uint8(g)
        imsave('./malware_images_cropped/'+file[:-4]+".png", g)
        # exit(0)

# from PIL import Image
# import leargist

# image = Image.open('33b711ab30af29989a95d76cb05eb0fe.png')
# New_im = image.resize((64, 64))
# imsave('reize_33b711ab30af29989a95d76cb05eb0fe.png', New_im)
# des = leargist.color_gist(New_im)
# Feature_Vector = des[0:320]
